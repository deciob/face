// Generated by CoffeeScript 1.4.0

define(['jquery'], function($) {
  'use strict';

  var facebook, getFriends, getLoginStatus, login, testAPI;
  window.fbAsyncInit = function() {
    console.debug("window.fbAsyncInit");
    return FB.init({
      appId: "463955970313826",
      channelUrl: "http://radiant-wave-5172.herokuapp.com/channel",
      status: true,
      cookie: true,
      xfbml: true
    });
  };
  login = function(callback) {
    console.debug("login", FB);
    return FB.login(function(response) {
      if (response.authResponse) {
        console.debug("login # connected");
        return callback();
      } else {
        return console.debug("login # cancelled");
      }
    });
  };
  testAPI = function() {
    console.log("Welcome!  Fetching your information.... ");
    return FB.api("/me", function(response) {
      return console.log("Good to see you, " + response.name + ".");
    });
  };
  getLoginStatus = function(callback) {
    return FB.getLoginStatus(function(response) {
      if (response.status === "connected") {
        console.debug("connected");
        return callback();
      } else if (response.status === "not_authorized") {
        console.debug("not_authorized");
        return login(callback);
      } else {
        console.debug("not_logged_in");
        return login(callback);
      }
    });
  };
  getFriends = function() {
    var _this = this;
    return FB.api("/me/friends", function(response) {
      if (response.data) {
        console.debug(response.data);
        return _this.trigger("onGetFriends", [response.data]);
      } else {
        return console.debug("facebook:getFriends:Error!");
      }
    });
  };
  return facebook = {
    login: login,
    testAPI: testAPI,
    getLoginStatus: getLoginStatus,
    getFriends: getFriends
  };
});
